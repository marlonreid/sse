apiVersion: debezium.io/v1beta1
kind: DebeziumServer
metadata:
  name: postgres-connector
  namespace: debezium
spec:
  connector:
    config:
      connector.class: io.debezium.connector.postgresql.PostgresConnector
      database.hostname: your-postgres-host
      database.port: 5432
      database.user: ${DB_USERNAME}
      database.password: ${DB_PASSWORD}
      database.dbname: your_db
      database.server.name: production-db
      plugin.name: pgoutput
      topic.prefix: debezium
      schema.include.list: public
      table.include.list: public.*
      
      # Event Hubs configuration
      transforms: route
      transforms.route.type: org.apache.kafka.connect.transforms.RegexRouter
      transforms.route.regex: (.*)
      transforms.route.replacement: $1
      
      producer.bootstrap.servers: your-eventhubs-namespace.servicebus.windows.net:9093
      producer.security.protocol: SASL_SSL
      producer.sasl.mechanism: PLAIN
      producer.sasl.jaas.config: org.apache.kafka.common.security.plain.PlainLoginModule required username="$ConnectionString" password="${EVENTHUBS_CONNECTION_STRING}";












-------------



  apiVersion: debezium.io/v1beta1
kind: DebeziumServer
metadata:
  name: postgres-connector
  namespace: debezium
spec:
  env:
    - name: DB_USERNAME
      valueFrom:
        secretKeyRef:
          name: db-credentials
          key: username
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: db-credentials
          key: password
    - name: EVENTHUBS_CONNECTION_STRING
      valueFrom:
        secretKeyRef:
          name: eventhubs-connection
          key: connection-string

  connector:
    config:
      connector.class: io.debezium.connector.postgresql.PostgresConnector
      database.hostname: your-postgres-host
      database.port: 5432
      database.user: ${env:DB_USERNAME}  # Corrected reference syntax
      database.password: ${env:DB_PASSWORD}
      database.dbname: your_db
      database.server.name: production-db
      plugin.name: pgoutput
      topic.prefix: debezium
      
      # Event Hubs configuration
      producer.bootstrap.servers: your-eventhubs-namespace.servicebus.windows.net:9093
      producer.security.protocol: SASL_SSL
      producer.sasl.mechanism: PLAIN
      producer.sasl.jaas.config: |
        org.apache.kafka.common.security.plain.PlainLoginModule required
        username="$ConnectionString"
        password="${env:EVENTHUBS_CONNECTION_STRING}";
